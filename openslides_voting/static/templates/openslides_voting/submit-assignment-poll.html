<style type="text/css">
    .voting-icon {
      width: 35px;
      height: 34px;
    }
    .gray-icon {
        filter: grayscale(100%);
        -webkit-filter: grayscale(100%);
    }
</style>

<div class="header">
  <div class="title">
    <div class="submenu">
      <a href="javascript:history.back()" class="btn btn-sm btn-default">
        <i class="fa fa-angle-double-left fa-lg"></i>
        <translate>Back</translate>
      </a>
    </div>
    <h1>
      <translate>Vote for</translate>
      {{ poll.assignment.getTitle() }}
    </h1>
    <div class="row" ng-if="apb">
      <div class="col-sm-12">
        <strong>
          <translate>You have voted for</translate>
        </strong>
        <div>
          <div ng-repeat="option in poll.options | orderBy: 'weight'"
            ng-if="poll.pollmethod !== 'votes'">
            {{ option.candidate.full_name }}:
            <span ng-if="apb.vote[option.candidate.id] === 'Y'" translate>
              Yes
            </span>
            <span ng-if="apb.vote[option.candidate.id] === 'N'" translate>
              No
            </span>
            <span ng-if="apb.vote[option.candidate.id] === 'A'" translate>
              Abstain
            </span>
          </div>
          <span ng-if="poll.pollmethod === 'votes'">
            {{ getUserVotedFor() }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="details">
  <div uib-alert ng-show="alert.show" ng-class="'alert-' + (alert.type || 'warning')" close="alert={}">
    {{ alert.msg }}
  </div>

  <table class="table table-striped table-bordered" ng-if="poll.pollmethod !== 'votes'">
    <thead>
      <tr>
        <th translate>Candidates</th>
        <th translate>Yes</th>
        <th translate>No</th>
        <th ng-if="poll.pollmethod === 'yna'" translate>Abstain</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="option in poll.options | orderBy: 'weight'">
        <td>{{ option.candidate.full_name }}</td>
        <td ng-click="votes[option.candidate.id] = 'Y'">
            <img src="/static/img/button-yes.png" class="voting-icon pointer"
              ng-class="{'gray-icon': votes[option.candidate.id] !== 'Y'}">
        </td>
        <td ng-click="votes[option.candidate.id] = 'N'">
            <img src="/static/img/button-no.png" class="voting-icon pointer"
              ng-class="{'gray-icon': votes[option.candidate.id] !== 'N'}">
        </td>
        <td ng-click="votes[option.candidate.id] = 'A'"
          ng-if="poll.pollmethod === 'yna'">
            <img src="/static/img/button-abstain.png" class="voting-icon pointer"
              ng-class="{'gray-icon': votes[option.candidate.id] !== 'A'}">
        </td>
      </tr>
    </tbody>
  </table>
  <table class="table table-striped table-bordered" ng-if="poll.pollmethod === 'votes'">
    <thead>
      <tr>
        <th translate>Candidates</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="option in poll.options | orderBy: 'weight'">
        <td>{{ option.candidate.full_name }}</td>
        <td>
          <span class="pointer" ng-click="votes.candidateIndex = ($index + 1)">
            <i class="fa fa-lg" ng-class="votes.candidateIndex === ($index + 1) ? 'fa-star' : 'fa-star-o'"></i>
          </span>
        </td>
      </tr>
    </tbody>
  </table>
  <button type="button" class="btn btn-primary spacer-top" ng-click="vote()">
    <translate>Submit</translate>
  </button>
</div>
